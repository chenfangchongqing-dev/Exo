<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>U2 · Grammaire — Imparfait ou Passé composé</title>
<style>
  :root{--ink:#1f2937;--muted:#64748b;--bg:#f6f8fb;--line:#cbd5e1;--brand:#2f5580;--ok:#16a34a;--err:#dc2626;}
  html,body{margin:0;background:var(--bg);color:var(--ink);font-family:ui-sans-serif,system-ui,Arial}
  .wrap{max-width:980px;margin:28px auto 64px;padding:0 16px}
  h1{font-size:22px;margin:0 0 12px}
  .card{background:#fff;border:1px solid #b6c2cf;border-radius:10px;box-shadow:0 2px 10px rgba(0,0,0,.05);padding:18px 18px 8px}
  .card h2{margin:0 0 10px;font-size:22px}
  .txt{line-height:1.9}
  input.blank{
    width:auto; min-width:120px; font-size:16px; padding:6px 8px; margin:0 4px;
    border:1px solid var(--line); border-radius:6px; outline:none; background:#fff;
  }
  input.blank.ok{background:#dcfce7;border-color:#86efac}
  input.blank.err{background:#fee2e2;border-color:#fecaca}
  .tools{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
  button{background:var(--brand);color:#fff;border:0;border-radius:10px;padding:9px 14px;cursor:pointer}
  button.secondary{background:#e5e7eb;color:#111}
  button.ghost{background:#fff;border:1px solid var(--line);color:#374151}
  .hint{color:var(--muted);font-size:14px;margin-top:8px}
  .ex{color:#16a34a;font-weight:700}
  kbd{font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; font-size:12px; background:#eef2f7; padding:2px 6px; border-radius:6px; border:1px solid #d6dde6}
</style>
</head>
<body>
<div class="wrap">
  <a href="/Exo/Grammaire/" style="text-decoration:none;color:#2563eb">← 返回语法目录</a>
  <h1>Conjuguez les verbes au <i>passé composé</i> ou à l’<i>imparfait</i>.</h1>

  <div class="card">
    <h2>Un bel exemple de solidarité !</h2>
    <div class="txt">
      Hawa, une jeune Malienne, <span class="ex">est arrivée</span> (arriver) en France en 2019, à l’âge de 16 ans.
      Elle <input class="blank" data-answer="a reçu" placeholder="..." /> (recevoir) une aide sociale comme mineure étrangère et elle
      <input class="blank" data-answer="s’est installée" placeholder="..." /> (s’installer) à Bordeaux où elle
      <input class="blank" data-answer="est allée" placeholder="..." /> (aller) au lycée.
      Puis elle <input class="blank" data-answer="a fait" placeholder="..." /> (faire) un BTS en commerce international.
      Chaque jour, elle <input class="blank" data-answer="se levait" placeholder="..." /> (se lever) tôt pour aller en cours et elle
      <input class="blank" data-answer="travaillait" placeholder="..." /> (travailler) très tard le soir.
      Quand elle <input class="blank" data-answer="a eu" placeholder="..." /> (avoir) son diplôme, une entreprise
      <input class="blank" data-answer="a proposé|a proposé" placeholder="..." /> (proposer) de l’embaucher,
      mais Hawa n’ <input class="blank" data-answer="avait" style="min-width:80px" placeholder="..." /> (avoir) pas le droit d’avoir un emploi sans autorisation de la préfecture.
      Ses amis <input class="blank" data-answer="se sont mobilisés" placeholder="..." /> (se mobiliser) pour l’aider à obtenir ce droit le plus vite possible.
      Trois mois plus tard, elle <input class="blank" data-answer="a obtenu" placeholder="..." /> (obtenir) l’autorisation de travailler
      et <input class="blank" data-answer="est devenue" placeholder="..." /> (devenir) l’employée la plus célèbre de son entreprise.
    </div>

    <div class="tools">
      <button id="verify">Vérifier</button>
      <button id="reset" class="secondary">Réinitialiser</button>
    </div>
    <div class="hint">说明：答案区分**时态与助动词**（含反身代词的变位与过去分词配合）；不区分大小写。法式/直引号均可。快捷：<kbd>Enter</kbd> 验证，<kbd>Esc</kbd> 重置。</div>
  </div>
</div>

<script>
  // 允许的可选写法（多个用 | 分隔）；比较时大小写不敏感，法式/直引号统一。
  const blanks = Array.from(document.querySelectorAll('input.blank'));
  const norm = s => (s||"")
      .toString()
      .trim()
      .toLowerCase()
      .replaceAll("’","'")            // 法式引号 → 直引号
      .replace(/\s+/g," ");           // 合并空格

  function checkOne(input){
    const answer = input.dataset.answer.split("|").map(norm);
    const val = norm(input.value);
    const ok = answer.includes(val);
    input.classList.toggle('ok', ok);
    input.classList.toggle('err', !ok && val.length>0);
    return ok;
  }

  function verifyAll(){
    let okCount = 0;
    blanks.forEach(inp => { if (checkOne(inp)) okCount++; });
    return okCount;
  }

  function resetAll(){
    blanks.forEach(inp => { inp.value=""; inp.classList.remove('ok','err'); });
    blanks[0]?.focus();
  }

  function showAll(){
    blanks.forEach(inp => {
      // 如果有多个合法答案，展示第一个
      inp.value = inp.dataset.answer.split("|")[0];
      inp.classList.remove('err');
    });
  }

  // 事件
  document.getElementById('verify').addEventListener('click', verifyAll);
  document.getElementById('reset').addEventListener('click', resetAll);
  document.getElementById('show').addEventListener('click', showAll);

  // Enter 验证；Esc 重置
  document.addEventListener('keydown', (e)=>{
    if(e.key==="Enter") verifyAll();
    if(e.key==="Escape") resetAll();
  });
</script>
</body>
</html>
