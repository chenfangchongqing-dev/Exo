<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vocabulaire – Compléter les tweets</title>

  <!-- 如果你有全站统一 style.css，就按需要调整路径 -->
  <link rel="stylesheet" href="../../style.css">

  <style>
    body{
      font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
      background: radial-gradient(circle at 0 0,#eff6ff 0,#f5f7fb 40%,#f9fafb 100%);
      color:#0f172a;
      margin:0;
    }
    header,main,footer{
      max-width:1000px;
      margin:0 auto;
      padding:20px;
    }
    h1{margin:.1rem 0;font-size:1.6rem;}
    .hint{color:#64748b;font-size:.92rem;}

    .card{
      background:#ffffff;
      border-radius:14px;
      border:1px solid #e5e7eb;
      padding:18px;
      box-shadow:0 8px 22px rgba(15,23,42,0.06);
      margin-top:16px;
    }

    /* ==== 词库 chip ==== */
    .word-bank{
      margin-bottom:12px;
      font-size:0.95rem;
    }
    .word-bank-label{
      display:block;
      margin-bottom:4px;
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:6px;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid #d4d4d8;
      background:#f9fafb;
      font-size:0.9rem;
      cursor:pointer;
      user-select:none;
      transition:all .12s ease-out;
    }
    .chip:hover{
      border-color:#0ea5e9;
      box-shadow:0 0 0 2px rgba(14,165,233,0.25);
      transform:translateY(-1px);
    }
    .chip.used{
      opacity:.5;
      border-style:dashed;
    }

    /* ===== 推特气泡布局 ===== */
    .tweets-grid{
      display:grid;
      grid-template-columns: minmax(0,1fr) minmax(0,1fr);
      gap:16px;
      margin-top:10px;
    }
    @media (max-width:768px){
      .tweets-grid{
        grid-template-columns:1fr;
      }
    }

    .tweet-item{
      display:flex;
      align-items:flex-start;
      gap:8px;
    }
    .tweet-label{
      font-weight:600;
      color:#9b87a8;
      min-width:1.4em;
    }

    .tweet-bubble{
      position:relative;
      background:#e7f5ff;
      border-radius:16px;
      padding:10px 14px;
      border:1px solid #cbdcf2;
      box-shadow:0 4px 12px rgba(148,163,184,0.25);
      flex:1;
    }
    .tweet-bubble::before{
      content:"";
      position:absolute;
      left:-10px;
      top:12px;
      border-width:8px 10px 8px 0;
      border-style:solid;
      border-color:transparent #e7f5ff transparent transparent;
      filter:drop-shadow(0 0 1px rgba(148,163,184,0.6));
    }

    .tweet-text{
      font-size:0.95rem;
    }

    /* ==== 可点击/拖拽空格 ==== */
    .gap-blank{
      display:inline-flex;
      min-width:120px;
      padding:0 4px 1px;
      margin:0 2px;
      border-bottom:1px dotted #6b7280;
      border-radius:3px;
      background:rgba(255,255,255,0.55);
      cursor:pointer;
      transition:all .12s ease-out;
    }
    .gap-blank.active{
      border-bottom-style:solid;
      border-bottom-color:#0ea5e9;
      background:rgba(255,255,255,0.95);
      box-shadow:0 0 0 2px rgba(14,165,233,0.25);
    }
    .gap-blank.gap-correct{
      background:#ecfdf5;
      border-bottom-color:#16a34a !important;
    }
    .gap-blank.gap-wrong{
      background:#fef2f2;
      border-bottom-color:#dc2626 !important;
    }

    .btn-check{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:8px 16px;
      border-radius:999px;
      border:1px solid #0ea5e9;
      background:#0ea5e9;
      color:#fff;
      font-size:0.95rem;
      cursor:pointer;
      margin-top:16px;
      transition:all .15s ease-out;
    }
    .btn-check:hover{
      background:#0284c7;
      border-color:#0284c7;
      transform:translateY(-1px);
      box-shadow:0 10px 26px rgba(14,165,233,0.4);
    }

    .score-box{
      margin-top:10px;
      padding:8px 12px;
      border-radius:10px;
      border:1px solid #e5e7eb;
      background:#f9fafb;
      font-size:0.9rem;
      color:#334155;
    }
  </style>
</head>
<body>
  <header>
    <a href="../" style="text-decoration:none;color:#0ea5e9">← Retour</a>
    <h1>Vocabulaire – Compléter les messages</h1>
    <p class="hint">
      Complétez les messages avec les mots ou expressions proposés.<br>
      PC：拖拽词块到空格；手机：先点空格高亮，再点词块。完成后点击 “Vérifier / 检查答案”。
    </p>
  </header>

  <main class="card">
    <!-- 词汇栏 -->
    <div class="word-bank">
      <span class="word-bank-label"><strong>Complétez avec :</strong></span>
      <div class="chips" id="wordBank">
        <div class="chip" draggable="true" data-word="l’assurance maladie">l’assurance maladie</div>
        <div class="chip" draggable="true" data-word="médecin">médecin</div>
        <div class="chip" draggable="true" data-word="assuré">assuré</div>
        <div class="chip" draggable="true" data-word="cabinet médical">cabinet médical</div>
        <div class="chip" draggable="true" data-word="remboursement">remboursement</div>
        <div class="chip" draggable="true" data-word="pharmacies">pharmacies</div>
        <div class="chip" draggable="true" data-word="consultation médicale">consultation médicale</div>
        <div class="chip" draggable="true" data-word="numéro de sécurité sociale">numéro de sécurité sociale</div>
        <div class="chip" draggable="true" data-word="en pleine forme">en pleine forme</div>
      </div>
    </div>

    <!-- 推特气泡布局 -->
    <div class="tweets-grid">

      <!-- a -->
      <div class="tweet-item">
        <div class="tweet-label">a.</div>
        <div class="tweet-bubble">
          <div class="tweet-text">
            Quand je suis arrivé en France, je me suis inscrit à
            <strong> l’assurance maladie</strong>. Mais je n’ai toujours pas reçu mon
            <span class="gap-blank" data-answer="numéro de sécurité sociale"></span>
            .<br>
            Si je consulte un
            <span class="gap-blank" data-answer="médecin"></span>
            , est-ce que j’aurai droit à un
            <span class="gap-blank" data-answer="remboursement"></span>
            ?
          </div>
        </div>
      </div>

      <!-- b -->
      <div class="tweet-item">
        <div class="tweet-label">b.</div>
        <div class="tweet-bubble">
          <div class="tweet-text">
            Tu n’as pas l’air d’être
            <span class="gap-blank" data-answer="en pleine forme"></span>
            !<br>
            Pourquoi tu ne vas pas faire une
            <span class="gap-blank" data-answer="consultation médicale"></span>
            ?
          </div>
        </div>
      </div>

      <!-- c -->
      <div class="tweet-item">
        <div class="tweet-label">c.</div>
        <div class="tweet-bubble">
          <div class="tweet-text">
            Avec l’assurance maladie, vous êtes
            <span class="gap-blank" data-answer="assuré"></span>
            quand vous voyagez à l’étranger.
          </div>
        </div>
      </div>

      <!-- d -->
      <div class="tweet-item">
        <div class="tweet-label">d.</div>
        <div class="tweet-bubble">
          <div class="tweet-text">
            Est-ce que les
            <span class="gap-blank" data-answer="pharmacies"></span>
            prennent aussi la carte vitale ?<br>
            Je dois acheter des médicaments.
          </div>
        </div>
      </div>

      <!-- e -->
      <div class="tweet-item">
        <div class="tweet-label">e.</div>
        <div class="tweet-bubble">
          <div class="tweet-text">
            Tu peux m’envoyer l’adresse du
            <span class="gap-blank" data-answer="cabinet médical"></span>
            du docteur Girard ?
          </div>
        </div>
      </div>

    </div>

    <!-- 按钮 + 得分显示 -->
    <button type="button" class="btn-check" id="checkBtn">
  Vérifier / 检查答案
</button>
<button type="button" class="btn-check" id="resetBtn" style="background:#e5e7eb;border-color:#e5e7eb;color:#111827;">
  Réinitialiser / 重做
</button>
<div id="scoreBox" class="score-box" style="display:none;"></div>
  </main>

  <footer class="hint" style="max-width:1000px;margin:0 auto 20px;padding:0 20px;">
    © 《高级法语综合课》
  </footer>

  <script>
    const blanks = Array.from(document.querySelectorAll(".gap-blank"));
    const chips  = Array.from(document.querySelectorAll(".chip"));
    const scoreBox = document.getElementById("scoreBox");
    let activeBlank = null;

    function setBlank(blank, word){
      // 清除这个空格之前的内容
      blank.textContent = "";
      blank.classList.remove("gap-correct","gap-wrong");
      // 如果别的空格里已经用了同一个词，把那里的删掉（保证一个词只用一次）
      blanks.forEach(b => {
        if (b !== blank && b.textContent.trim() === word){
          b.textContent = "";
          b.classList.remove("gap-correct","gap-wrong");
        }
      });
      blank.textContent = word;

      // 标记 chip 已使用（只是视觉效果）
      chips.forEach(chip=>{
        if(chip.dataset.word === word){
          chip.classList.add("used");
        }
      });
    }

    // 空格：点击选中 + 接收拖拽
    blanks.forEach(blank=>{
      blank.addEventListener("click", ()=>{
        if(activeBlank === blank){
          blank.classList.remove("active");
          activeBlank = null;
        }else{
          blanks.forEach(b=>b.classList.remove("active"));
          blank.classList.add("active");
          activeBlank = blank;
        }
      });

      blank.addEventListener("dragover", e=>e.preventDefault());
      blank.addEventListener("drop", e=>{
        e.preventDefault();
        const word = e.dataTransfer.getData("text/plain");
        if(word) setBlank(blank, word);
      });
    });

    // 词块：点击 / 拖拽
    chips.forEach(chip=>{
      chip.addEventListener("click", ()=>{
        if(!activeBlank) return;
        const word = chip.dataset.word;
        setBlank(activeBlank, word);
      });

      chip.addEventListener("dragstart", e=>{
        e.dataTransfer.setData("text/plain", chip.dataset.word);
      });
    });

    // Vérifier
    document.getElementById("checkBtn").addEventListener("click", ()=>{
      let total = blanks.length;
      let score = 0;

      blanks.forEach(blank=>{
        const expected = (blank.dataset.answer || "").trim().toLowerCase();
        const user     = (blank.textContent || "").trim().toLowerCase();

        blank.classList.remove("gap-correct","gap-wrong");

        if(!user){
          blank.classList.add("gap-wrong");
          return;
        }

        if(user === expected){
          blank.classList.add("gap-correct");
          score++;
        }else{
          blank.classList.add("gap-wrong");
        }
      });

      scoreBox.style.display = "block";
      scoreBox.textContent = `Score : ${score} / ${total}`;
    });
  </script>
</body>
</html>
